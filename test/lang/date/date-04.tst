/*
    Date calculations
 */

if (!this.assert) {
    this.assert = function (cond) {
        if (!cond) {
            throw new Error("Test Failed")
        }
    }
}

//  Verify conversion to gregorian values

var results = [
"16725254400000 2500 Fri Jan 01 2500 00:00:00",
"16409721600000 2490 Sun Jan 01 2490 00:00:00",
"16094102400000 2480 Mon Jan 01 2480 00:00:00",
"15778569600000 2470 Wed Jan 01 2470 00:00:00",
"15462950400000 2460 Thu Jan 01 2460 00:00:00",
"15147417600000 2450 Sat Jan 01 2450 00:00:00",
"14831798400000 2440 Sun Jan 01 2440 00:00:00",
"14516265600000 2430 Tue Jan 01 2430 00:00:00",
"14200646400000 2420 Wed Jan 01 2420 00:00:00",
"13885113600000 2410 Fri Jan 01 2410 00:00:00",
"13569494400000 2400 Sat Jan 01 2400 00:00:00",
"13253961600000 2390 Mon Jan 01 2390 00:00:00",
"12938342400000 2380 Tue Jan 01 2380 00:00:00",
"12622809600000 2370 Thu Jan 01 2370 00:00:00",
"12307190400000 2360 Fri Jan 01 2360 00:00:00",
"11991657600000 2350 Sun Jan 01 2350 00:00:00",
"11676038400000 2340 Mon Jan 01 2340 00:00:00",
"11360505600000 2330 Wed Jan 01 2330 00:00:00",
"11044886400000 2320 Thu Jan 01 2320 00:00:00",
"10729353600000 2310 Sat Jan 01 2310 00:00:00",
"10413820800000 2300 Mon Jan 01 2300 00:00:00",
"10098288000000 2290 Wed Jan 01 2290 00:00:00",
"9782668800000 2280 Thu Jan 01 2280 00:00:00",
"9467136000000 2270 Sat Jan 01 2270 00:00:00",
"9151516800000 2260 Sun Jan 01 2260 00:00:00",
"8835984000000 2250 Tue Jan 01 2250 00:00:00",
"8520364800000 2240 Wed Jan 01 2240 00:00:00",
"8204832000000 2230 Fri Jan 01 2230 00:00:00",
"7889212800000 2220 Sat Jan 01 2220 00:00:00",
"7573680000000 2210 Mon Jan 01 2210 00:00:00",
"7258147200000 2200 Wed Jan 01 2200 00:00:00",
"6942614400000 2190 Fri Jan 01 2190 00:00:00",
"6626995200000 2180 Sat Jan 01 2180 00:00:00",
"6311462400000 2170 Mon Jan 01 2170 00:00:00",
"5995843200000 2160 Tue Jan 01 2160 00:00:00",
"5680310400000 2150 Thu Jan 01 2150 00:00:00",
"5364691200000 2140 Fri Jan 01 2140 00:00:00",
"5049158400000 2130 Sun Jan 01 2130 00:00:00",
"4733539200000 2120 Mon Jan 01 2120 00:00:00",
"4418006400000 2110 Wed Jan 01 2110 00:00:00",
"4102473600000 2100 Fri Jan 01 2100 00:00:00",
"3786940800000 2090 Sun Jan 01 2090 00:00:00",
"3471321600000 2080 Mon Jan 01 2080 00:00:00",
"3155788800000 2070 Wed Jan 01 2070 00:00:00",
"2840169600000 2060 Thu Jan 01 2060 00:00:00",
"2524636800000 2050 Sat Jan 01 2050 00:00:00",
"2209017600000 2040 Sun Jan 01 2040 00:00:00",
"1893484800000 2030 Tue Jan 01 2030 00:00:00",
"1577865600000 2020 Wed Jan 01 2020 00:00:00",
"1262332800000 2010 Fri Jan 01 2010 00:00:00",
"946713600000 2000 Sat Jan 01 2000 00:00:00",
"631180800000 1990 Mon Jan 01 1990 00:00:00",
"315561600000 1980 Tue Jan 01 1980 00:00:00",
"28800000 1970 Thu Jan 01 1970 00:00:00",
"-315590400000 1960 Fri Jan 01 1960 00:00:00",
"-631123200000 1950 Sun Jan 01 1950 00:00:00",
"-946742400000 1940 Mon Jan 01 1940 00:00:00",
"-1262275200000 1930 Wed Jan 01 1930 00:00:00",
"-1577894400000 1920 Thu Jan 01 1920 00:00:00",
"-1893427200000 1910 Sat Jan 01 1910 00:00:00",
"-2208960000000 1900 Mon Jan 01 1900 00:00:00",
"-2524492800000 1890 Wed Jan 01 1890 00:00:00",
"-2840112000000 1880 Thu Jan 01 1880 00:00:00",
"-3155644800000 1870 Sat Jan 01 1870 00:00:00",
"-3471264000000 1860 Sun Jan 01 1860 00:00:00",
"-3786796800000 1850 Tue Jan 01 1850 00:00:00",
"-4102416000000 1840 Wed Jan 01 1840 00:00:00",
"-4417948800000 1830 Fri Jan 01 1830 00:00:00",
"-4733568000000 1820 Sat Jan 01 1820 00:00:00",
"-5049100800000 1810 Mon Jan 01 1810 00:00:00",
"-5364633600000 1800 Wed Jan 01 1800 00:00:00",
"-5680166400000 1790 Fri Jan 01 1790 00:00:00",
"-5995785600000 1780 Sat Jan 01 1780 00:00:00",
"-6311318400000 1770 Mon Jan 01 1770 00:00:00",
"-6626937600000 1760 Tue Jan 01 1760 00:00:00",
"-6942470400000 1750 Thu Jan 01 1750 00:00:00",
"-7258089600000 1740 Fri Jan 01 1740 00:00:00",
"-7573622400000 1730 Sun Jan 01 1730 00:00:00",
"-7889241600000 1720 Mon Jan 01 1720 00:00:00",
"-8204774400000 1710 Wed Jan 01 1710 00:00:00",
"-8520307200000 1700 Fri Jan 01 1700 00:00:00",
"-8835840000000 1690 Sun Jan 01 1690 00:00:00",
"-9151459200000 1680 Mon Jan 01 1680 00:00:00",
"-9466992000000 1670 Wed Jan 01 1670 00:00:00",
"-9782611200000 1660 Thu Jan 01 1660 00:00:00",
"-10098144000000 1650 Sat Jan 01 1650 00:00:00",
"-10413763200000 1640 Sun Jan 01 1640 00:00:00",
"-10729296000000 1630 Tue Jan 01 1630 00:00:00",
"-11044915200000 1620 Wed Jan 01 1620 00:00:00",
"-11360448000000 1610 Fri Jan 01 1610 00:00:00",
"-11676067200000 1600 Sat Jan 01 1600 00:00:00",
"-11991600000000 1590 Mon Jan 01 1590 00:00:00",
"-12307219200000 1580 Tue Jan 01 1580 00:00:00",
"-12622752000000 1570 Thu Jan 01 1570 00:00:00",
"-12938371200000 1560 Fri Jan 01 1560 00:00:00",
"-13253904000000 1550 Sun Jan 01 1550 00:00:00",
"-13569523200000 1540 Mon Jan 01 1540 00:00:00",
"-13885056000000 1530 Wed Jan 01 1530 00:00:00",
"-14200675200000 1520 Thu Jan 01 1520 00:00:00",
"-14516208000000 1510 Sat Jan 01 1510 00:00:00",
"-14831740800000 1500 Mon Jan 01 1500 00:00:00",
"-15147273600000 1490 Wed Jan 01 1490 00:00:00",
"-15462892800000 1480 Thu Jan 01 1480 00:00:00",
"-15778425600000 1470 Sat Jan 01 1470 00:00:00",
"-16094044800000 1460 Sun Jan 01 1460 00:00:00",
"-16409577600000 1450 Tue Jan 01 1450 00:00:00",
"-16725196800000 1440 Wed Jan 01 1440 00:00:00",
"-17040729600000 1430 Fri Jan 01 1430 00:00:00",
"-17356348800000 1420 Sat Jan 01 1420 00:00:00",
"-17671881600000 1410 Mon Jan 01 1410 00:00:00",
"-17987414400000 1400 Wed Jan 01 1400 00:00:00",
"-18302947200000 1390 Fri Jan 01 1390 00:00:00",
"-18618566400000 1380 Sat Jan 01 1380 00:00:00",
"-18934099200000 1370 Mon Jan 01 1370 00:00:00",
"-19249718400000 1360 Tue Jan 01 1360 00:00:00",
"-19565251200000 1350 Thu Jan 01 1350 00:00:00",
"-19880870400000 1340 Fri Jan 01 1340 00:00:00",
"-20196403200000 1330 Sun Jan 01 1330 00:00:00",
"-20512022400000 1320 Mon Jan 01 1320 00:00:00",
"-20827555200000 1310 Wed Jan 01 1310 00:00:00",
"-21143088000000 1300 Fri Jan 01 1300 00:00:00",
"-21458620800000 1290 Sun Jan 01 1290 00:00:00",
"-21774240000000 1280 Mon Jan 01 1280 00:00:00",
"-22089772800000 1270 Wed Jan 01 1270 00:00:00",
"-22405392000000 1260 Thu Jan 01 1260 00:00:00",
"-22720924800000 1250 Sat Jan 01 1250 00:00:00",
"-23036544000000 1240 Sun Jan 01 1240 00:00:00",
"-23352076800000 1230 Tue Jan 01 1230 00:00:00",
"-23667696000000 1220 Wed Jan 01 1220 00:00:00",
"-23983228800000 1210 Fri Jan 01 1210 00:00:00",
"-24298848000000 1200 Sat Jan 01 1200 00:00:00",
"-24614380800000 1190 Mon Jan 01 1190 00:00:00",
"-24930000000000 1180 Tue Jan 01 1180 00:00:00",
"-25245532800000 1170 Thu Jan 01 1170 00:00:00",
"-25561152000000 1160 Fri Jan 01 1160 00:00:00",
"-25876684800000 1150 Sun Jan 01 1150 00:00:00",
"-26192304000000 1140 Mon Jan 01 1140 00:00:00",
"-26507836800000 1130 Wed Jan 01 1130 00:00:00",
"-26823456000000 1120 Thu Jan 01 1120 00:00:00",
"-27138988800000 1110 Sat Jan 01 1110 00:00:00",
"-27454521600000 1100 Mon Jan 01 1100 00:00:00",
"-27770054400000 1090 Wed Jan 01 1090 00:00:00",
"-28085673600000 1080 Thu Jan 01 1080 00:00:00",
"-28401206400000 1070 Sat Jan 01 1070 00:00:00",
"-28716825600000 1060 Sun Jan 01 1060 00:00:00",
"-29032358400000 1050 Tue Jan 01 1050 00:00:00",
"-29347977600000 1040 Wed Jan 01 1040 00:00:00",
"-29663510400000 1030 Fri Jan 01 1030 00:00:00",
"-29979129600000 1020 Sat Jan 01 1020 00:00:00",
"-30294662400000 1010 Mon Jan 01 1010 00:00:00",
]

var i = 0
for (y = 2500; y > 1000; y -= 10) {
    d = new Date(y, 0, 1)
    offset = d - 0
    line = offset + " " + y + " " + d
    // print(line)
    assert(line.replace(/:00 .*/, ":00") == results[i++])
}

d = new Date

if (d.format) {
    if (d.format("%Z") == "PDT") {
        assert(d.getTimezoneOffset() == 420)
    } else if (d.format("%Z") == "PST") {
        assert(d.getTimezoneOffset() == 480)
    }
}
